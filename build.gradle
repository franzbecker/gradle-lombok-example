plugins {
    id 'java'
    id 'io.franzbecker.gradle-lombok' version '1.14'
}

apply plugin: 'war'
apply plugin: 'maven-publish'

repositories {
    jcenter()
}

dependencies {
    testCompile 'junit:junit:4.12'
}

group = 'com.example'

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
        }
    }
    repositories {
        maven {
            url "$buildDir/repo"
        }
    }
}

model {
    tasks.generatePomFileForMavenJavaPublication {
        destination = file("$buildDir/generated-pom.xml")
    }
}

import io.franzbecker.gradle.lombok.task.DelombokTask

task delombok(type: DelombokTask, dependsOn: compileJava) {
    ext.outputDir = file("$buildDir/delombok")
    outputs.dir(outputDir)
    sourceSets.main.java.srcDirs.each {
        inputs.dir(it)
        args(it, "-d", outputDir)
    }
}
